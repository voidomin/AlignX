============================= test session starts =============================
platform win32 -- Python 3.12.4, pytest-9.0.2, pluggy-1.6.0
rootdir: C:\Users\akash\Documents\project\projects bio\mustang_pipeline
plugins: anyio-4.4.0, asyncio-1.3.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 31 items

tests\test_async_pdb.py ..                                               [  6%]
tests\test_cache_management.py .                                         [  9%]
tests\test_config_validation.py ...                                      [ 19%]
tests\test_mustang_runner.py ........                                    [ 45%]
tests\test_pdb_manager.py .....F                                         [ 64%]
tests\test_pipeline.py ..                                                [ 70%]
tests\test_rmsd_analyzer.py .........                                    [100%]

================================== FAILURES ===================================
__________________ TestPDBManager.test_clean_specific_chain ___________________

self = <test_pdb_manager.TestPDBManager object at 0x0000018DB3B445F0>
mock_config = {'app': {'max_proteins': 5, 'name': 'Test App'}, 'filtering': {'remove_heteroatoms': True, 'remove_water': True}, 'mus...tang', 'timeout': 10}, 'pdb': {'max_file_size_mb': 10, 'source_url': 'https://files.rcsb.org/download/', 'timeout': 5}}
temp_workspace = {'cleaned': WindowsPath('C:/Users/akash/AppData/Local/Temp/pytest-of-akash/pytest-63/test_clean_specific_chain0/data/c...sults'), 'root': WindowsPath('C:/Users/akash/AppData/Local/Temp/pytest-of-akash/pytest-63/test_clean_specific_chain0')}

    def test_clean_specific_chain(self, mock_config, temp_workspace):
        """Test cleaning a specific chain from a multi-chain PDB."""
        manager = PDBManager(mock_config)
        manager.cleaned_dir = temp_workspace["cleaned"]
    
        # Create multi-chain content
        multi_content = (
            "ATOM      1  N   ALA A   1      11.104  13.203   7.334  1.00 20.00           N\n"
            "TER\n"
            "ATOM      2  N   ALA B   1      21.104  23.203  17.334  1.00 20.00           N\n"
            "TER"
        )
    
        raw_file = temp_workspace["raw"] / "multi.pdb"
        raw_file.write_text(multi_content)
    
        # Clean only chain B
        success, msg, cleaned_path = manager.clean_pdb(raw_file, chain="B")
    
>       assert success is True
E       assert False is True

tests\test_pdb_manager.py:99: AssertionError
=========================== short test summary info ===========================
FAILED tests/test_pdb_manager.py::TestPDBManager::test_clean_specific_chain
======================== 1 failed, 30 passed in 6.47s =========================
